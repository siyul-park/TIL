# 컴퓨터 구조 및 설계

## TLB

### 빠른 주소 변환: TLB

- 가상 메모리에서 이중 메모리 접근

  1. 물리적 주소를 획득 (즉, 페이지 테이블을 판독)
  2. 데이터 얻기

- TBL (translation-lookaside buffer)

  - 
  - 최근에 사용 된 주소 사상을 추적하여 페이지 테이블에 대한 접근을 피하는 캐시

- TLB의 일반적인 매개 변수

  | TLB 크기  | 16-512 항목                           |
  | --------- | ------------------------------------- |
  | 블록 크기 | 1~2 PTEs (일반적으로 각각 4-8 바이트) |
  | 성공 시간 | 0.5~1 클락 사이클                     |
  | 실패 벌칙 | 10100 클락 사이클                     |
  | 실패률    | 0.01%~1%                              |

  

### 내부적으로 FastMATH을 가지고 있는 TLB

- 16 항목, 64 비트/항목
- 완전 연관 사상
- 항목 = 20-비트 테그 + 20-비트 물리 페이지 숫자 + 유효 비트 + 더러운 비트 + 다른 서적유지 비트들



### 가상 메모리, TLB 및 캐시 통합

|      | cache | TLB  | virtual<br/>memory |                                |
| ---- | ----- | ---- | ------------------ | ------------------------------ |
| 0    | hit   | hit  | hit                | 최고의 경우                    |
| 1    | miss  | hit  | hit                | 가능함 페이지 테이블 접근 없음 |
| 2    | hit   | miss | hit                | TLB 실패                       |
| 3    | miss  | miss | hit                | TLB와 캐쉬 실패                |
| 4    | miss  | miss | miss               | 페이지 실패                    |
|      | miss  | hit  | miss               | 불가능                         |
|      | hit   | hit  | miss               | 불가능                         |
|      | hit   | miss | miss               | 불가능                         |



### 고민

- 물리적으로 인덱싱되고 물리적으로 태그가 지정된 캐시
  - 캐시 적중 시간 = TLB 액세스 시간 + 캐시 액세스 시간
- 가상적으로 색인이 생성되고 가상으로 태그가 지정된 캐시 (가상 캐시 = 가상 캐시)
  - 주소 변환 하드웨어는 일반적인 캐시 액세스 중에 사용되지 않습니다.
  - 별칭 (또는 동의어) 문제
- 사실상 인덱싱되고 물리적으로 태그가 지정된 캐시
  - 캐시 인덱스는 페이지 오프셋에 포함됨
  - 캐시 및 TLB의 병렬 액세스



### 가상 메모리로 보호 구현하기

- 보호 및 페이지 테이블
  - 각 프로세스의 가상 주소 공간을 매핑하여 물리적 페이지가 분리됩니다.
    - 다른 프로세스 데이터에 액세스 할 수 없습니다.
  - 사용자 프로세스의 테이블 수정 방지
  - 페이지 테이블 : OS의 보호 된 주소 공간
- 쓰기 방지 비트
  - 각 페이지 테이블 엔트리에 포함
  - 모든 메모리 접근시 점검