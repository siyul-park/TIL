# 데이터 통신과 네트워크

## TCP/IP

### 서비스 및 레이어링

- 계층 : 서비스를 담당
  - 그들은 자신의 레이어 기능을 가지고 이들의 기능은 다음 하위 계층 서비스 위에 구축됨
  - 한 계층의 서비스에는 모든 하위 수준의 서비스가 포함됨



#### 서비스는 투명해야 한다

##### 서비스를 투명하게 만들기 위한 요구 사항

- xxx는 작업을 완벽하게 수행해야 한다
- 메시지 형식이나 형식 변경이 없어야 한다
- 서비스가 투명하지 않은 서비스 위에 구축 된 경우에도 투명하지 않다 (비 투명 + 투명 = 비 투명)



##### 투명한 전송 서비스

- 전송 서비스는 원본과 대상 간의 메시지 전송을 담당한다
- 전송 서비스는 응용 프로그램에 투명하므로 프로그래머는 네트워크 프로토콜의 세부 사항을 이해할 필요가 없다



### TCP

#### 호스트 장치에서만 작동

- 사용자 메시지를 전달할 때 통신 노드의 TCP는 사용되지 않는다

- 통신 노드의 TCP는 호스트 데이터 전달에 사용되지 않는다
  - 출처 -> 목적지 : 데이터
  - 대상 <- 출처 : ack (확인 패킷)



#### 라우터에서 왜 사용하지 않는가?

- TCP는 많은 CPU 자원을 소비하지 않는다. 그렇다면 라우터 용량이 1/10 미만으로 줄어들 것이다.



#### TCP 주요 기능 : 소스 노드의 메시지는 변경되지 않고 대상 노드로 전달되어야 한다

- 만약 수신 순서가 P1, P2, P3, P5, P6 이라면,
  - 대상 노드가 P4 재전송 요청
- 만약 수신 순서가 P1, P2, P4, P3 이라면,
  - 대상 노드는 P3 및 P4를 재 배열



#### TCP의 기능

- 신뢰할 수 있는 데이터 전송
- 연결 제어
  - 상태를 연결, 해제, 연결 설정, 연결된 상태 및 해제 상태로 나눔.
    - 안정적인 데이터 전송, 흐름 제어, 혼잡 제어는 연결된 상태에서만 수행
- 흐름 제어
  - 네트워크가 정상이면 데이터 전송 속도를 최대한 높임
- 혼잡 제어
  - 네트워크가 정체 된 것처럼 보이면 소스 노드에서 데이터 속도를 줄여 네트워크가 빠르게 정상화 하도록 한다



### 비 연결 데이터 전송 : UDP

- 패킷을 생성 한 이후 바로 데이터를 전송할 수 있음
- 하나의 상태만 있습니다 (이 상태를 무국적이라고합니다).
- 형식 확인 이외의 기능은 수행하지 않습니다.
  - 주소 확인, 데이터 전송 오류 확인
  - 안정적인 데이터 전송, 연결 제어, 흐름 제어, 혼잡 제어 없음



#### 우리는 언제 UDP를 사용합니까?

- voIP : 실시간 통신 (예 : 실시간 인터넷 방송)
  - 재전송은 시간이 너무 많이 걸리므로 쓸모가 없다
  - 시간이 지난 화면 데이터는 사용할 수 없다
  - 일반적으로 실시간 멀티미디어 데이터 손실은 품질이 떨어지더라도 치명적이지는 않다
- dns (도메인 이름 시스템) : 1. DNS 쿼리 + 2. DNS 응답.
  - 이런 종류의 간단한 작업에는 TCP 오버 헤드가 너무 무겁다
- snmp (간단한 네트워크 관리 프로토콜) :
  - 긴급하게 데이터를 보내야 한다
  - 대량의 중요하지 않은 데이터
  - 몇 개의 패킷 손실은 중요한 것이 아니다.
- TCP와 같은 기능을 수행하기위한 특수 프로그램이 상위 계층에 제공됨 : p2p, nfs
  - 일부 응용 프로그램은 TCP 기능의 일부를 원한다



### IP

- 전 세계 주소
- 기능 : 라우터의 정보를 사용하여 대상 노드로 연결
- 네트워크 노드 유형은 네트워크 유형에 따라 결정된다



#### 네트워크 노드 유형은 네트워크 유형에 따라 결정

| 노드의 유형 | 네트워크      | 연결/비 연결 |
| ----------- | ------------- | ------------ |
| 라우터      | 인터넷        | 비 연결      |
| ATM 스위치  | ATM 네트워크  | 연결 지향    |
| 전화 스위치 | 전화 네트워크 | 연결 지향    |



#### 네트워크 유형

##### 연결 지향 네트워크

- 연결 설정 상태, 연결 상태, 해제 상태, 연결 해제 상태로 구분
- 연결되면 경로가 고정되고 패킷이 FIFO와 함께 전송

##### 비 연결 네트워크

- 네트워크 상태에 따라 라우팅 경로는 패킷 단위에 따라 변경
- 연결된 네트워크에서 라우팅 경로는 통화 단위에 따라 변경 (전화 통화)



#### 네트워크 비교

| 항목        | 연결 지향 네트워크 | 비 연결 지향 네트워크 |
| ----------- | ------------------ | --------------------- |
| 상태 정의   | 많은 상태          | 하나의 상태           |
| s/w 복잡성  | 복잡하고 김        | 짧고 쉬움             |
| 가격        | 비쌈               | 쌈                    |
| 서비스 품질 | 좋음               | 나쁨                  |



#### 라우팅

1. 네트워크 주소를 사용하여 먼저 LAN을 찾는다
2. 호스트 주소를 사용하여 LAN에서 호스트를 찾는다



- Ip 주소 : 호스트 주소와 네트워크 주소로 구분

- 네트워크 주소 : 라우터에서 사용
- 호스트 주소 : LAN 스위치에 사용



#### CIDR : 클래스 없는 도메인 간 라우팅 기법 (현재 사용중)

- 더 이상 3-class 나누기를 사용하지 않는다
  - 임의의 비트에서 네트워크 주소와 호스트 주소를 구분할 수 있음
- 네트워크 크기를 선언하려면 마스킹 비트가 필요



#### 계층 적 주소 구조

주소 공격 : 높은 수준의 라우터는 주소 공격으로 메모리를 줄입니다.



#### 두 개의 포트가 대상과 일치하면 어떻게 되는가?

- 예) 인터넷의 두 링크 모두에 대해 200.23.18.15 일치
- 일치하는 비트가 더 큰 링크를 선택
- prefix 최대 접두사 일치



#### IP 주소 통합

- IP 주소가 어떻게 할당되었는지는 외부에는 알려지지 않고
- 단지 주소를 통합하고 분할하는 직역 라우터끼리만 알고 있음.
  - 라우터가 기억해야 할 주소의 갯수를 획기적으로 줄인다.



#### IP 주소와 맥 주소

- IP 주소 : 집 주소와 유사
  - 소유 할 수 없다
    - ICANN / KRNIC가 요청하면 사용자가 이를 반환해야 한다
    - 때때로 조직은 주소를 재정렬한다. (디스크 조각 모음과 유사)
  - 지역이 있습니다 (이웃 노드는 유사한 주소를 가진다)
  - 이동후 변경이 된다
- mac 주소 : ID와 유사 (학생 ID, 주민등록증)
  - 소유 할 수 있다
  - 이동 후 변경되지 않음



#### 부족한 IPv4의 개수를 아끼는 방법

- IPv6 사용 : 주소자리가 4에서 16으로 대폭적으로 증가함.
- CIDR 사용 : 유연한 주소체계를 허용하여서 주소 낭비를 없앰.
- DHCP 사용 : IP pool 방식으로 소요되는 IP수를 줄임
  - 통신을 사용할 때에만 통신노드에게 IP 한 개를 빌려주고 완료 후에 다시 회수함
- NAT 사용 : 하나의 IP만으로 port번호를 이용하여 수천대의 단말기에 주소를 부여함.
  - 기관에서 intra-net을 구축하는 경우에 보안상의 이유로 IP를 공개하지 않기 위해서
  - 인트라넷에서는 local IP가 주어지며 외부연결시에는 사용가능한 port 주소를 하나 할당 받아서 사용함. 
  - 외부에서 볼때는 DHCP에서처럼 특정 호스트의 주소가 바뀔수 있음. 